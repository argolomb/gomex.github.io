<html>
<head>
  <meta charset="UTF-8">
  <title>Gerência de configurações com o Puppet</title>
  <link rel="icon" type="image/x-icon" href="arquivos/raul-hacker-club-icon.png" />
  <script src="arquivos/jquery-2.0.0.js"></script>
  <script src="arquivos/coffee-script.js"></script>
  <link rel="stylesheet" href="arquivos/highlight.js/styles/default.css">
  <script src="arquivos/highlight.js/highlight.pack.js"></script>
  <script src="arquivos/coffee-term.js"></script>
  <link rel="stylesheet" type="text/css" href="arquivos/style.css" />
</head>
<body>
<div id="impress" data-transition-duration="700">
  <div id="abertura" class="step" data-x="1200" data-y="-100" data-scale="4">
    <img src="imagens/puppet-logo.png" height="300px">
    <br>
    <div id="contato">rafael.gomes@ufba.br</div>
    <div id="onde">CRI &mdash; STI &mdash; UFBA</div>
    <div id="contato">http://ufba.br &mdash; http://techfree.com.br</div>
  </div>
  <div id="intro" class="step" data-x="2450" data-y="-900" data-scale="1.5" data-rotate="-10">
    <h1>Gerência de configurações com o Puppet</h1>
  </div>
  <div class="step" data-x="4000" data-y="-1900">
    <h1>Como era antes do puppet?</h1>
    <center>
    <img src="imagens/sysadmin.jpg" height="500px">
    </center>
  </div>
  <div class="step" data-x="4000" data-y="-1100">
    <h1>Tarefas repetitivas</h1>
    <center>
    <img src="imagens/martelo.gif" height="600px">
    </center>
  </div>
  <div class="step" data-x="4000" data-y="-400">
    <h1>Scripts</h1>
    <center>
          <img src="imagens/escrita-script.gif" height="400px">
    </center>
  </div>  
  <div class="step" data-x="4000" data-y="300">
    <h1>E quando seu script não trata erro?</h1>
    <center>
          <img src="imagens/script-sem-tratamento.gif" height="400px">
    </center>
  </div>
  <div class="step" data-x="4000" data-y="1000">
    <h1>Replicabilidade</h1>
    <center>
          <img src="imagens/replicabilidade.gif" height="600px">
    </center>
  </div> 
  <div class="step" data-x="5000" data-y="1700">
    <h1>Qual a melhor solução?</h1>
    <center>
          <img src="imagens/solucao.gif" height="500px">
    </center>

  </div> 
  <div class="step" data-x="3000" data-y="700" data-rotate="90">
    <h1>Mudança de paradigma</h1>
    <center>
          <img src="imagens/declarative-imperative.png" height="400px">
    </center>

</div>
  <div class="step" data-x="3000" data-y="2100" data-rotate="90">
    <h1>Gerência de configuração</h1>
        <center>
          <img src="imagens/gerencia-configuracao.gif" height="500px">
        </center>
  </div>
  <div class="step" data-x="4000" data-y="1800">
        <center>
          <img src="imagens/puppet-logo.png" height="600px">
        </center>
  </div> 
<!--  <div class="step" data-x="4000" data-y="2250">
    <h1>Modificando a imagem</h1>
    <h4># docker exec `docker ps -q -l` touch /etc/linguagil</h4>
    <h4># docker commit `docker ps -q -l` nginx:linguagil</h4>
    <h4># docker stop `docker ps -q -l`</h4>
    <h4># docker run -d -p 80:80 nginx:linguagil</h4>
    <h4># docker exec `docker ps -q -l` ls /etc/linguagil</h4>
  </div> -->

  <div class="step" data-x="2000" data-y="1800" data-rotate="90">
    <h1>Puppet</h1>
    <h4>Feito de Sysadmin para Sysadmin</h4>
    <h4>Não é programação</h4>
    <h4>Extensível usando código Ruby</h4>
    <h4>Funciona com ou sem servidor central</h4>
    <h4>Comunicação segura com SSL</h4>
    <h4>Suporte a 19 sistemas operacionais (Linux, BSD, Windows...)</h4>
  </div>

  <div class="step" data-x="2000" data-y="3000" data-rotate="90">
    <h1>Arquitetura puppet</h1>
        <center>
          <img src="imagens/arquitetura-puppet.png" height="620px">
        </center>
  </div>

  <div class="step" data-x="2000" data-y="4400" data-rotate="90">
    <h1>Estrutura dos módulos</h1>
        <center>
          <img src="imagens/estrutura-puppet.png" height="400px">
        </center>
  </div>

  <div class="step" data-x="1000" data-y="1800" data-rotate="180">
    <h1>Exemplo init.pp</h1>
    <p>class exemplo (<br>
      $config            = $exemplo::params::config,<br>
      $config_template   = $exemplo::params::config_template,<br>
      $pack_ensure       = $exemplo::params::package_ensure,<br>
      $package_name      = $exemplo::params::package_name,<br>
      $service_enable    = $ntp::params::service_enable,
      $service_ensure    = $ntp::params::service_ensure,
      $service_manage    = $ntp::params::service_manage,
      $service_name      = $ntp::params::service_name
    ) inherits exemplo::params {<br>
      include exemplo::install<br>
      include exemplo::config<br>
      include exemplo::service<br>
  </div>

  <div class="step" data-x="3600" data-y="-3100" data-rotate="-90">
    <h1>Exemplo install.pp</h1>
    <p>class exemplo::install {<br>
        package { 'exemplo':<br>
        ensure => $pack_ensure,<br>
        name   => $package_name,<br>
      }<br>
<br>
    }<br>
  </div>
  <div class="step" data-x="4600" data-y="-3100" data-rotate="-90">
    <h1>Exemplo config.pp</h1>
    <p>class exemplo::config {<br>
        file { $config:<br>
        ensure  => file,<br>
        owner   => 0,<br>
        group   => 0,<br>
        mode    => '0644',<br>
        content => template($config_template),<br>
      }<br>
<br>
    }<br>
  </div>
  <div class="step" data-x="5600" data-y="-3100" data-rotate="-90">
    <h1>Exemplo service.pp</h1>
    <p>class exemplo::service {<br>
         service { 'exemplo':<br>
          ensure     => $service_ensure,<br>
          enable     => $service_enable,<br>
          name       => $service_name,<br>
          hasstatus  => true,<br>
          hasrestart => true,<br>
      }<br>
<br>
    }<br>
  </div>
    <div class="step" data-x="6600" data-y="-3100" data-rotate="90">
    <h1>Finalizando com o puppet</h1>
        <center>
          <img src="imagens/final-puppet.gif" height="500px">
        </center>
  </div>
  <div class="step" data-x="7600" data-y="-3100" data-rotate="-90">
    <h1>Perguntas?</h1>
  </div>

<!-- id="impress" -->
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div id="term-border">
  <div id="term">
    <pre class="code coffee" onmouseover="coffeeTerm.editMode(true)"></pre>
    <pre class="code js"></pre>
    <div class="output"></div>
    <!-- button onclick="coffeeTerm.run()">Executar</button -->
    <img id="run" src="arquivos/run.svg" onclick="coffeeTerm.run()" width="26"/>
  </div>
</div>
<script src="arquivos/impress.js"></script>
<script type="text/coffeescript">
    # Ajusta tópicos da apresentação
    $('.step').each (nStep, step)->
        metaStep = $('<div class="metaStep"/>').insertBefore step
        metaStep.attr 'id', 'meta-' + step.id  if step.id
        $(step).appendTo metaStep
        $('li', step).each (nLi, li)->
            if 'visible' not in li.classList
                newStep = $(step).clone().appendTo metaStep
                newStep[0].id += '-' + 'ABCDEFGHIJKLMNOPQRSTUWXYZ'[nLi] if newStep[0].id
                for i in [1..nLi+1]
                    $("li:nth-of-type(#{i})", newStep).addClass 'visible'

    # Remove indentação base (o espaçamento da primeira linha) nos fontes
    for codeEl in $('pre code')
        lines = codeEl.innerHTML.replace(/^\s*\n/, '').split '\n'
        indent = lines[0].match(/^(\s*)/)[1]
        lines = lines.map (l)-> l[indent.length..]
        codeEl.innerHTML = lines.join '\n'

    # Highlight dos fontes
    do hljs.initHighlightingOnLoad

    # CSS Workarrounds
    nav = window.navigator.userAgent.match(/webkit|firefox/i)[0].toLowerCase()
    $(document.body).addClass nav

    # Inicia apresentação
    $ -> do impress().init
</script>
</body>
</html>
